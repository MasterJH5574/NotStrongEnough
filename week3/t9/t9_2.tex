\input{../template.tex}

\begin{document}

\begin{thm}{t9}{}
    Derive a formula for $\mathbb{E}_\pi[C(\pi, k)]$, up to additive terms of order $o(n)$. You might want to introduce $???? = k / n$.
\end{thm}

\begin{itemize}
    \item case $i<k<j$:
        \begin{math}
            \sum _{i=1}^{k-1} \sum _{j=k+1}^n \frac{1}{j-i+1} &< \sum _{i=1}^{k-1} \int_{k+1}^{n+1} \frac{1}{j-i} \mathrm{d} j \\
                                              &= \sum _{i=1}^{k-1} \ln(n+1-i) - \ln(k+1-i) \\
                                              &< \int_{i=0}^{k-1} \ln(n+1-i) - \ln(k-i) \mathrm{d} i \\
                                              &= (n+1)\ln(n+1) - k\ln k - (n-k+2)\ln(n-k+2)
        .\end{math}

        On the other hand, similarly we can have
        \begin{math}
            \sum _{i=1}^{k-1} \sum _{j=k+1}^n \frac{1}{j-i+1} &> -(-k+n+2) \ln (-k+n+2)-(k+2) \ln (k+2)+(n+1) \ln (n+1)+3 \ln (3)
        .\end{math}

        The difference between the upper bound and the lower bound is $o(n)$, thus the inaccuracy is $o(n)$.

        To write this formula more simply, we have
        \begin{math}
            \sum _{i=1}^{k-1} \sum _{j=k+1}^n \frac{1}{j-i+1} = n \ln n - k \ln k - (n-k) \ln (n-k) + o(n)
        .\end{math}

        Summing three terms up,
        \begin{math}
            \mathbb{E}_\pi[C(\pi,k)] = n - 1 - H_k - H_{n-k+1} + n\ln n - k\ln k - (n-k)\ln (n-k) + o(n)
        .\end{math}

\end{itemize}

\end{document}
